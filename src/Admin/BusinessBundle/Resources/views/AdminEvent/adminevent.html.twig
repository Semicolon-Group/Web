{% extends 'admin_base.html.twig' %}
{% block title %}Admin | Businesses{% endblock %}
{% block page_title %}Businesses{% endblock %}
{% block body %}

    <div id="business_events_delete" data-path = "{{ path('business_events_delete') }}"></div>

    <div class="panel">
        <div class="panel-heading">
            <h3 class="panel-title">Event</h3>
        </div>

        <div id="selected_post" data-id=""></div>
        <div class="panel-body">
            <label for='Recherche' class="menu-item kode-parent-menu" style="color: dodgerblue">Recherche :</label>
            <input type="text" name="search" id="search" />
            <br><br>
            <div id="selected_post" data-id=""></div>
            <table class="table" id="contenu">
                <thead>
                <tr>
                    <th>Title</th>



                </tr>
                </thead>
                <tbody>
                {% for event in events %}
                    <tr id="{{ event.id }}">
                        <td>{{ event.title }}</td>

                        <td><a href="{{ path('Admin_events_edit',{'id':event.id}) }}">Edit</a></td>
                        <td><span class="label label-{% if event.state==1 %}success{% elseif event.state==0 %}warning{% elseif event.state==2 %}danger{% endif %}">{% if event.state==1 %} approved {% elseif event.state==0 %}not processed{% elseif event.state==2 %} denied {% endif %}</span></td>

                    </tr>
                {% endfor %}
                </tbody>
            </table>

            <div class="navbar-btn">
                <button type="button" class="btn-toggle-fullwidth"><i class="lnr lnr-arrow-left-circle"></i></button>
            </div>

        </div>
    </div>
    <script src="{{ asset('business_assets/js/jquery-3.2.1.js') }}"></script>

    <script>

        function delete_event(id) {
            var DATA = {'id':id};
            var path = $("#business_events_delete").data('path');
            $.ajax({
                type: 'POST',
                data: DATA,
                url: path,
                success: function(data){
                    $("#" + id).remove();
                }

            });
        }

        $(document).ready( function() {
            // dÃ©terminer l'index des colonnes les colonnes
            var colonnes = {};
            $("#contenu thead th").each(function(index, th)
                {
                    colonnes[index] = $(th).text();
                }
            );

// faire la recherche dans le tableau
            $("#search").keyup(function()
            {
                var mots = $(this).val().toLowerCase().split(" ");
                $("#contenu tbody tr").each(function(index, tr)
                {
                    if (mots[0].length > 0) $(tr).hide(); else $(tr).show();
                    $("td", tr).each(function(index, td)
                    {
                        if (colonnes[index] in {'Title':true,'content':true})
                        {
                            for (mot in mots)
                            {
                                if (mots[mot].length > 0 && $(td).text().toLowerCase().indexOf(mots[mot])>= 0)
                                {
                                    $(tr).show();
                                    return false;
                                }
                            }
                        }
                    });
                });
            });

        });

    </script>
{% endblock %}